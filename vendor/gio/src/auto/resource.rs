// This file was generated by gir (c3b4020) from gir-files (71d73f0)
// DO NOT EDIT

use Error;
use ResourceLookupFlags;
use ffi;
use glib;
use glib::translate::*;
use std;
use std::ptr;

glib_wrapper! {
    pub struct Resource(Shared<ffi::GResource>);

    match fn {
        ref => |ptr| ffi::g_resource_ref(ptr),
        unref => |ptr| ffi::g_resource_unref(ptr),
    }
}

impl Resource {
    pub fn new_from_data(data: &glib::Bytes) -> Result<Resource, Error> {
        unsafe {
            let mut error = ptr::null_mut();
            let ret = ffi::g_resource_new_from_data(data.to_glib_none().0, &mut error);
            if error.is_null() { Ok(from_glib_full(ret)) } else { Err(from_glib_full(error)) }
        }
    }

    pub fn enumerate_children(&self, path: &str, lookup_flags: ResourceLookupFlags) -> Result<Vec<String>, Error> {
        unsafe {
            let mut error = ptr::null_mut();
            let ret = ffi::g_resource_enumerate_children(self.to_glib_none().0, path.to_glib_none().0, lookup_flags.to_glib(), &mut error);
            if error.is_null() { Ok(FromGlibPtrContainer::from_glib_full(ret)) } else { Err(from_glib_full(error)) }
        }
    }

    //pub fn get_info(&self, path: &str, lookup_flags: ResourceLookupFlags) -> Result<(/*Unimplemented*/Fundamental: Size, u32), Error> {
    //    unsafe { TODO: call ffi::g_resource_get_info() }
    //}

    pub fn lookup_data(&self, path: &str, lookup_flags: ResourceLookupFlags) -> Result<glib::Bytes, Error> {
        unsafe {
            let mut error = ptr::null_mut();
            let ret = ffi::g_resource_lookup_data(self.to_glib_none().0, path.to_glib_none().0, lookup_flags.to_glib(), &mut error);
            if error.is_null() { Ok(from_glib_full(ret)) } else { Err(from_glib_full(error)) }
        }
    }

    //pub fn open_stream(&self, path: &str, lookup_flags: ResourceLookupFlags) -> Result</*Ignored*/InputStream, Error> {
    //    unsafe { TODO: call ffi::g_resource_open_stream() }
    //}

    pub fn load<T: AsRef<std::path::Path>>(filename: T) -> Result<Resource, Error> {
        unsafe {
            let mut error = ptr::null_mut();
            let ret = ffi::g_resource_load(filename.as_ref().to_glib_none().0, &mut error);
            if error.is_null() { Ok(from_glib_full(ret)) } else { Err(from_glib_full(error)) }
        }
    }
}
