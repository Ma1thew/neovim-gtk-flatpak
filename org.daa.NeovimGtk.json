{
    "app-id": "org.daa.NeovimGtk",
    "runtime": "org.gnome.Platform",
    "runtime-version": "3.24",
    "sdk": "org.gnome.Sdk",
    "command": "nvim-gtk",
    "finish-args": [
        "--share=ipc",
	"--socket=x11",
        "--socket=wayland",
        "--filesystem=host:rw",
	"--filesystem=~/.config/nvim:ro",
        "--share=network",
        "--socket=pulseaudio"
    ],
	"cleanup": ["/app/rustc"],
	"modules": [
      {
            "name":"rust",
            "sources": [
		    
            "sources": [
                {
                    "type": "archive",
                    "only-arches": ["i386"],
                    "url": "https://static.rust-lang.org/dist/rust-1.20.0-i686-unknown-linux-gnu.tar.gz",
                    "sha256": "abe592e06616cdc2fcca56ddbe482050dd49a1fada35e2af031c64fe6eb14668"
                },
                {
                    "type": "archive",
                    "only-arches": ["arm"],
                    "url": "https://static.rust-lang.org/dist/rust-1.20.0-arm-unknown-linux-gnueabihf.tar.gz",
                    "sha256": "d8282b04619acdcbb5259ba5a3c8677716a015cfef3ba68ba24211590c5bb5dc"
                },
                {
                    "type": "archive",
                    "only-arches": ["aarch64"],
                    "url": "https://static.rust-lang.org/dist/rust-1.20.0-aarch64-unknown-linux-gnu.tar.gz",
                    "sha256": "eaab3df489d4d8f976c4327d812b9870730eed6d0bbd52712767083d02be7472"
                },
                {
                    "type": "archive",
                    "only-arches": ["x86_64"],
                    "url": "https://static.rust-lang.org/dist/rust-1.20.0-x86_64-unknown-linux-gnu.tar.gz",
                    "sha256": "ca1cf3aed73ff03d065a7d3e57ecca92228d35dc36d9274a6597441319f18eb8"
                },
                {
                    "type": "script", "commands": ["#!/bin/bash", "#empty configure", "exit 0"],
                    "dest-filename": "configure"
                },
                {
                    "type": "script",
                    "commands": ["all:",
                                 "	echo 'Nothing to do'",
                                 "install:", 
                                 "	./install.sh --prefix=/app/rustc"
                                ],
                    "dest-filename": "Makefile"
                },
                {
                    "type": "shell",
                    "commands": ["chmod +x configure"]
                }
            ]

      },
	  {
		  "name": "libtool",
		  "sources": [
			  {
				  "type": "archive",
				  "url": "http://ftpmirror.gnu.org/libtool/libtool-2.4.6.tar.gz",
				  "sha256": "e3bd4d5d3d025a36c21dd6af7ea818a2afcd4dfc1ea5a17b39d7854bcd0c06e3"
			  }
		  ]
	  },
	  {
		  "name": "neovim",
		  "build-options": {
			  "build-args": ["--share=network"]
		  },
		  "buildsystem": "simple",
		  "build-commands": [
			  "make BUILD_TYPE=\"Unix Makefiles\" CMAKE_EXTRA_FLAGS=\"-DCMAKE_INSTALL_PREFIX=/app\"",
			  "make BUILD_TYPE=\"Unix Makefiles\" CMAKE_EXTRA_FLAGS=\"-DCMAKE_INSTALL_PREFIX=/app\" install"
		  ],
		  "sources": [
			  {
				  "type": "git",
				  "url": "https://github.com/neovim/neovim",
				  "branch": "v0.1.7"
			  }
		  ]
	  },
      {
          "name": "neovim-gtk",
		  "build-options": {
			  "build-args": ["--share=network"]
		  },
		  "buildsystem": "simple",
		  "build-commands": [
			  "PATH=$PATH:/app/rustc/bin cargo build --release", 
			  "PREFIX=\"/app\" make install"			  
		  ],
          "sources": [
              {
                  "type": "git",
                  "url": "https://github.com/daa84/neovim-gtk",
                  "branch" : "master"
              }
          ]
      }
    ]
}
